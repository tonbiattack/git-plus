# Issue管理コマンド

GitHubのIssueの作成、編集、閲覧などのIssue管理に関するコマンドです。

## git issue-create

エディタで題名と本文を入力し、GitHubに新しいissueを作成します。ユーザーが設定しているエディタで編集できます。

**使い方:**
```bash
git issue-create
git issue-create -h              # ヘルプを表示
```

**処理フロー:**
1. ユーザーが設定しているエディタで題名と本文を入力
2. 入力内容でGitHubに新しいissueを作成
3. 作成したissueのURLを表示

**使用例:**
```bash
git issue-create
```

**実行の流れ:**
```
エディタで新しいissueを作成中... (code --wait)

# エディタで以下のような内容を入力:
# Title: 新機能の提案
# ---
#
# ダークモード機能を追加してほしいです。
# 詳細は以下の通りです...

✓ issueを作成しました
URL: https://github.com/username/repo/issues/45
```

**エディタの設定:**

エディタは以下の優先順位で自動検出されます：
1. `git config core.editor` の設定
2. 環境変数 `VISUAL`
3. 環境変数 `EDITOR`
4. デフォルト（vi）

VSCodeを使用する場合は、以下のように設定します：
```bash
git config --global core.editor "code --wait"
```

**一時ファイルの形式:**

エディタで開かれるファイルは以下のような形式です：
```markdown
# 新しいIssueを作成
#
# 以下のissueの題名と本文を入力してください。
# '#' で始まる行はコメントとして無視されます。
# 'Title:' の後に題名を記載し、'---' の区切り線の後に本文を記載してください。
# ファイルを保存して閉じると、issueが作成されます。
# ========================================

Title:

---

```

**主な機能:**
- **エディタで編集**: ユーザーが設定しているエディタで題名と本文を入力可能
- **コメント行除外**: `#` で始まる行はコメントとして無視
- **URL表示**: 作成後にissueのURLを表示
- **空チェック**: 題名が空の場合はissue作成をキャンセル

**注意事項:**
- GitHub CLI (`gh`) がインストールされている必要があります
- `gh auth login` でログイン済みである必要があります
- 題名は必須です。題名が空の場合はissue作成をキャンセルします
- 本文は空でも作成可能です
- タイトルは `Title:` の後に、本文は `---` の区切り線の後に記載します

## git issue-edit

GitHubのopenしているissueの一覧を表示し、選択したissueをエディタで編集します。題名（title）と本文（body）の両方を編集できます。-v/--viewオプションで閲覧のみ、-m/--commentオプションでコメント追加（クローズしない）、-c/--closeオプションでコメント入力後にクローズが可能です。

**使い方:**
```bash
git issue-edit              # 編集モード
git issue-edit -v           # 閲覧モード
git issue-edit --view       # 閲覧モード（ロングオプション）
git issue-edit -m           # コメント追加モード（クローズしない）
git issue-edit -c           # コメント入力後にクローズ
git issue-edit -h           # ヘルプを表示
```

**処理フロー（編集モード）:**
1. GitHubのopenしているissueを一覧表示
2. 番号を入力してissueを選択
3. 選択したissueの題名と本文を一時ファイルに書き出し
4. ユーザーが設定しているエディタで編集
5. 編集内容でissueを更新

**処理フロー（閲覧モード -v/--view）:**
1. GitHubのopenしているissueを一覧表示
2. 番号を入力してissueを選択
3. 選択したissueの題名と本文を表示
4. 編集は行わずに終了

**処理フロー（コメント追加モード -m/--comment）:**
1. GitHubのopenしているissueを一覧表示
2. 番号を入力してissueを選択
3. エディタでコメントを入力
4. コメントをissueに投稿（クローズしない）

**処理フロー（クローズモード -c/--close）:**
1. GitHubのopenしているissueを一覧表示
2. 番号を入力してissueを選択
3. エディタでコメントを入力（任意）
4. コメントが入力された場合は投稿
5. issueをクローズ

**使用例（編集モード）:**
```bash
git issue-edit
```

**実行の流れ（編集モード）:**
```
Open Issue一覧 (3 個):

1. #42: ログイン機能の不具合
   ログインボタンを押しても反応がない...

2. #43: ダークモード対応
   ダークモードのデザインを実装してほしい...

3. #44: パフォーマンス改善
   初回読み込みが遅いため改善が必要...

編集するissueを選択してください (番号を入力、Enterでキャンセル): 2

選択されたissue: #43
タイトル: ダークモード対応
URL: https://github.com/username/repo/issues/43

エディタで編集中... (code --wait)
✓ issueを更新しました
```

**使用例（閲覧モード）:**
```bash
git issue-edit -v
```

**使用例（コメント追加モード）:**
```bash
git issue-edit -m
```

**使用例（クローズモード）:**
```bash
git issue-edit -c
```

**エディタの設定:**

エディタは以下の優先順位で自動検出されます：
1. `git config core.editor` の設定
2. 環境変数 `VISUAL`
3. 環境変数 `EDITOR`
4. デフォルト（vi）

VSCodeを使用する場合は、以下のように設定します：
```bash
git config --global core.editor "code --wait"
```

**一時ファイルの形式（編集モード）:**

エディタで開かれるファイルは以下のような形式です：
```markdown
# Issue #43
# URL: https://github.com/username/repo/issues/43
#
# 以下のissueの題名と本文を編集してください。
# '#' で始まる行はコメントとして無視されます。
# 'Title:' の後に題名を記載し、'---' の区切り線の後に本文を記載してください。
# ファイルを保存して閉じると、issueが更新されます。
# ========================================

Title: ダークモード対応

---

現在の本文がここに表示されます。
この部分を編集して保存すると、issueが更新されます。
```

**一時ファイルの形式（コメント追加モード）:**

エディタで開かれるファイルは以下のような形式です：
```markdown
# Issue #43 へのコメント
# URL: https://github.com/username/repo/issues/43
#
# このissueに追加するコメントを記載してください。
# '#' で始まる行はコメントとして無視されます。
# ファイルを保存して閉じると、コメントが投稿されます。
# ========================================

```

**主な機能:**
- **一覧表示**: openしているissueを番号付きで表示
- **プレビュー**: 各issueの本文の最初の50文字をプレビュー表示
- **タイトル編集**: issueのタイトルも編集可能
- **本文編集**: issueの本文も編集可能
- **エディタ編集**: ユーザーが設定しているエディタで編集可能
- **コメント行除外**: `#` で始まる行はコメントとして無視
- **変更検出**: タイトルと本文の両方で変更を検出し、変更がない場合は更新をスキップ
- **閲覧モード**: -v/--viewオプションで編集せずに閲覧のみ可能
- **コメント追加**: -m/--commentオプションでエディタからコメントを追加可能（クローズしない）
- **issueクローズ**: -c/--closeオプションでコメント入力後にissueをクローズ可能
- **柔軟な運用**: コメントは任意で、空の場合はコメントなしでクローズ

**注意事項:**
- GitHub CLI (`gh`) がインストールされている必要があります
- `gh auth login` でログイン済みである必要があります
- タイトルと本文の両方を編集できます
- タイトルは `Title:` の後に、本文は `---` の区切り線の後に記載します
