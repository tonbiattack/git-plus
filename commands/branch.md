# ブランチ操作コマンド

ブランチの作成、切り替え、削除、同期などのブランチ管理に関するコマンドです。

## git newbranch

指定したブランチ名を一度削除してから作り直し、トラッキングブランチとしてチェックアウトします。

```bash
git newbranch feature/awesome
git newbranch -h                 # ヘルプを表示
```

**動作:**
1. 同名のローカルブランチが存在しない場合は、新しいブランチを作成して切り替えます。
2. 同名のローカルブランチが存在する場合は、以下の選択肢が表示されます：
   - `[r]ecreate`: ブランチを削除して作り直し
   - `[s]witch`: 既存のブランチに切り替え
   - `[c]ancel`: 処理を中止
3. recreate を選択すると、既存ブランチを強制削除してから新しいブランチを作成します。
4. switch を選択すると、既存ブランチに `git checkout` で切り替えます。

存在しないブランチを削除しようとした場合のエラーは無視されるため、安全に再作成できます。

## git delete-local-branches

`main` / `master` / `develop` 以外のマージ済みローカルブランチをまとめて削除します。

```bash
git delete-local-branches
git delete-local-branches -h     # ヘルプを表示
```

**動作:**
1. `git branch --merged` に含まれ、`main` / `master` / `develop` 以外のブランチを抽出します。
2. 削除候補を一覧表示し、確認プロンプトで `y` / `yes` が入力されたときのみ削除します。
3. 各ブランチを `git branch -d` で削除します。未統合で削除できなかった場合はエラーを表示し、処理結果を通知します。

## git recent

最近使用したブランチを時系列で表示し、番号で選択して簡単に切り替えられます。

```bash
git recent
git recent -h                    # ヘルプを表示
```

**動作:**
1. 最近コミットがあったブランチを最大10件、時系列順（最新順）に表示します。
2. 現在のブランチは一覧から除外されます。
3. 番号を入力することで、選択したブランチに即座に切り替えられます。
4. 空入力でキャンセルできます。

引数は不要です。頻繁に複数のブランチを行き来する場合や、最近作業していたブランチ名を思い出せない場合に便利です。

## git back

前のブランチやタグに戻ります。`git checkout -` のショートカットで、ブランチやタグ間の素早い移動に便利です。

```bash
git back
git back -h                      # ヘルプを表示
```

## git sync

現在のブランチをリモートのデフォルトブランチ（main/master）の最新状態と同期します。

```bash
git sync                    # 現在のブランチをリモートのデフォルトブランチと同期
git sync feature-branch     # 指定したブランチをリモートのデフォルトブランチと同期
git sync --continue         # コンフリクト解消後に同期を続行
git sync --abort            # 同期を中止して元の状態に戻す
git sync -h                 # ヘルプを表示
```

内部的にはrebaseを使用するため、きれいな履歴を保ちながら最新の変更を取り込めます。

**主な機能:**
- **自動ブランチ検出**: リモートのデフォルトブランチ（origin/main または origin/master）を自動検出します。
- **rebaseベースの同期**: マージコミットを作らずに、きれいな履歴を維持します。
- **コンフリクト処理**: コンフリクトが発生した場合は、解消後に`git sync --continue`で続行できます。
- **安全な中止**: `git sync --abort`で同期をキャンセルし、元の状態に戻せます。
- **進行中のrebase検出**: すでにrebase中の場合は適切なメッセージを表示します。

**使用例:**
1. feature-branch で作業中、main の最新変更を取り込みたい場合:
   ```bash
   git switch feature-branch
   git sync
   # コンフリクトが発生した場合は解消後に:
   git sync --continue
   ```

2. 別のブランチを同期したい場合:
   ```bash
   git sync develop
   ```

**注意事項:**
- リモートへプッシュ済みのコミットをrebaseすると、履歴が書き換わるため、チームで共有しているブランチでは注意が必要です。
- コンフリクトが発生した場合は、ファイルを編集してコンフリクトを解消し、`git add`した後に`git sync --continue`を実行してください。
